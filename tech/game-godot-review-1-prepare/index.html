<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.96.0"><meta name=theme-color content="#fff"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>复习 Godot 开发流程 其一 前期准备 | Everybody Wants Some</title><link rel=stylesheet href=/css/meme.min.27e4feb2de743859e620298592d1ee7b7c3e6e26bed549de122aca343d33522e.css><script src=/js/meme.min.45a777da25d0b1805991f984be4e9ae5e17f3ea94097882dff058256fa34eb17.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Rock+Salt&family=Ma+Shan+Zheng&family=IBM+Plex+Serif:ital,wght@0,400;0,600;1,400;1,600&family=Noto+Sans+SC:wght@400;700&family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:ital,wght@0,400;0,600;1,400;1,600&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=ZCOOL+KuaiLe&display=swap" media=print onload='this.media="all"'><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Rock+Salt&family=Ma+Shan+Zheng&family=IBM+Plex+Serif:ital,wght@0,400;0,600;1,400;1,600&family=Noto+Sans+SC:wght@400;700&family=Noto+Serif+SC:wght@400;700&family=Source+Code+Pro:ital,wght@0,400;0,600;1,400;1,600&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=ZCOOL+KuaiLe&display=swap"></noscript><meta name=author content="time2beat"><meta name=description content="隔了数月再捡起 Godot 居然觉得无所适从，找不到从何下手。 顿时一股悲哀从心底升起：曾几何时我……"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Everybody Wants Some"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Everybody Wants Some"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=https://ews.ink/tech/game-godot-review-1-prepare/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2022-04-08T22:52:10+08:00","dateModified":"2022-04-20T13:24:53+08:00","url":"https://ews.ink/tech/game-godot-review-1-prepare/","headline":"复习 Godot 开发流程 其一 前期准备","description":"隔了数月再捡起 Godot 居然觉得无所适从，找不到从何下手。 顿时一股悲哀从心底升起：曾几何时我……","inLanguage":"zh-CN","articleSection":"tech","wordCount":8991,"image":["https://img.shields.io/badge/Godot-官方文档-informational","https://img.shields.io/badge/文档-中文翻译-informational","https://img.shields.io/badge/GDScript-语法-informational"],"author":{"@type":"Person","description":"Everybody Wants Some","email":"po@ews.ink","image":"https://ews.ink/icons/avatar.jpg","url":"https://ews.ink/","name":"time2beat"},"license":"[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)","publisher":{"@type":"Organization","name":"Everybody Wants Some","logo":{"@type":"ImageObject","url":"https://ews.ink/icons/apple-touch-icon.png"},"url":"https://ews.ink/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://ews.ink/"}}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content="@sum1sos"><meta property="og:title" content="复习 Godot 开发流程 其一 前期准备"><meta property="og:description" content="隔了数月再捡起 Godot 居然觉得无所适从，找不到从何下手。 顿时一股悲哀从心底升起：曾几何时我……"><meta property="og:url" content="https://ews.ink/tech/game-godot-review-1-prepare/"><meta property="og:site_name" content="Everybody Wants Some"><meta property="og:locale" content="zh"><meta property="og:image" content="https://img.shields.io/badge/Godot-官方文档-informational"><meta property="og:type" content="article"><meta property="article:published_time" content="2022-04-08T22:52:10+08:00"><meta property="article:modified_time" content="2022-04-20T13:24:53+08:00"><meta property="article:section" content="tech"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Everybody Wants Some</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=/tags/><span class=menu-item-name>标签</span></a></li><li class=menu-item><a href=/tech/><span class=menu-item-name>技术</span></a></li><li class=menu-item><a href=/game/><span class=menu-item-name>游戏</span></a></li><li class=menu-item><a href=/life/><span class=menu-item-name>生活</span></a></li><li class=menu-item><a href=/about/><span class=menu-item-name>关于</span></a></li><li class=menu-item><a id=theme-switcher href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5 242 7a18 18 0 0128 0l48.8 97.5L422.2 70A18 18 0 01442 89.8l-34.5 103.4L505 242a18 18 0 010 28l-97.5 48.8L442 422.2A18 18 0 01422.2 442l-103.4-34.5L270 505a18 18 0 01-28 0l-48.8-97.5L89.8 442A18 18 0 0170 422.2l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8L70 89.8A18 18 0 0189.8 70zM256 128a128 128 0 10.01.0M256 160a96 96 0 10.01.0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412A256 256 0 10181 5a11.5 11.5.0 00-5 20A201.5 201.5.0 0142 399a11.5 11.5.0 00-15 13"/></svg></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=tech data-toc-num=true><h1 class="post-title p-name">复习 Godot 开发流程 其一 前期准备</h1><div class="post-subtitle p-name">工欲善其事 必先利其器</div><div class=post-meta><time datetime=2022-04-08T22:52:10+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2022.4.8</time>
<time datetime=2022-04-20T13:24:53+08:00 class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M4e2 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H48C21.49 64 0 85.49.0 112v352c0 26.51 21.49 48 48 48h352c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 4e2H54a6 6 0 01-6-6V160h352v298a6 6 0 01-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2022.4.20</time>
<span class="post-meta-item category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>&nbsp;<a href=/tech/ class="category-link p-category">Tech</a></span>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;8991</span>
<span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;18&nbsp;分钟</span>
<span class="post-meta-item busuanzi-page-pv" id=busuanzi_container_page_pv><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="icon post-meta-icon"><path d="M288 144a110.94 110.94.0 00-31.24 5 55.4 55.4.0 017.24 27 56 56 0 01-56 56 55.4 55.4.0 01-27-7.24A111.71 111.71.0 10288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35.0 000 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35.0 000-29.19zM288 4e2c-98.65.0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 4e2 288 4e2z"/></svg>&nbsp;<span id=busuanzi_value_page_pv></span></span></div><nav class=contents><h2 id=contents class=contents-title>目录</h2><ol class=toc><li><a id=contents:技术选型 href=#技术选型>技术选型</a></li><li><a id=contents:参考文档 href=#参考文档>参考文档</a></li><li><a id=contents:开发范式 href=#开发范式>开发范式</a><ol><li><a id=contents:代码格式 href=#代码格式>代码格式</a></li><li><a id=contents:命名约定 href=#命名约定>命名约定</a></li><li><a id=contents:代码顺序 href=#代码顺序>代码顺序</a></li></ol></li><li><a id=contents:常见-q--a href=#常见-q--a>常见 Q & A</a><ol><li><a id=contents:scenetree场景树和-nodetree节点树 href=#scenetree场景树和-nodetree节点树>SceneTree（场景树）和 NodeTree（节点树）</a></li><li><a id=contents:如何选择分辨率 href=#如何选择分辨率>如何选择分辨率</a></li><li><a id=contents:如何组织项目结构 href=#如何组织项目结构>如何组织项目结构</a></li><li><a id=contents:如何切换场景 href=#如何切换场景>如何切换场景</a><ol><li><a id=contents:手动更换场景 href=#手动更换场景>手动更换场景</a></li><li><a id=contents:直接切换场景树 href=#直接切换场景树>直接切换场景树</a></li></ol></li><li><a id=contents:何时使用场景与脚本 href=#何时使用场景与脚本>何时使用场景与脚本</a><ol><li><a id=contents:从性能方面考虑 href=#从性能方面考虑>从性能方面考虑</a></li><li><a id=contents:从易用性方面考虑 href=#从易用性方面考虑>从易用性方面考虑</a></li><li><a id=contents:从稳定性方面考虑 href=#从稳定性方面考虑>从稳定性方面考虑</a></li><li><a id=contents:结论 href=#结论>结论</a></li></ol></li><li><a id=contents:_processdelta-和-_physics_processdelta-该用哪个 href=#_processdelta-和-_physics_processdelta-该用哪个><code>_process(delta)</code> 和 <code>_physics_process(delta)</code> 该用哪个</a></li><li><a id=contents:_inputevent-和-_unhandled_inputevent-该用哪个 href=#_inputevent-和-_unhandled_inputevent-该用哪个><code>_input(event)</code> 和 <code>_unhandled_input(event)</code> 该用哪个</a></li><li><a id=contents:单例自动加载-autoload什么时候用 href=#单例自动加载-autoload什么时候用>单例（自动加载 <code>autoload</code>）什么时候用</a><ol><li><a id=contents:什么是-godot-的单例 href=#什么是-godot-的单例>什么是 Godot 的单例</a></li><li><a id=contents:godot-里单例的实际用法 href=#godot-里单例的实际用法>Godot 里单例的实际用法</a></li><li><a id=contents:应该在什么时机使用单例 href=#应该在什么时机使用单例>应该在什么时机使用单例</a></li></ol></li><li><a id=contents:如何快速调试使用-tool-工具脚本预览代码效果 href=#如何快速调试使用-tool-工具脚本预览代码效果>如何快速调试（使用 <code>tool</code> 工具脚本预览代码效果）</a></li><li><a id=contents:如何自定义数据结构 href=#如何自定义数据结构>如何自定义数据结构</a></li><li><a id=contents:如何应用面向对象原则 href=#如何应用面向对象原则>如何应用面向对象原则</a><ol><li><a id=contents:聚合-or-组合 href=#聚合-or-组合>聚合 or 组合</a></li><li><a id=contents:继承-or-构造 href=#继承-or-构造>继承 or 构造</a></li><li><a id=contents:场景如何与外部环境交互 href=#场景如何与外部环境交互>场景如何与外部环境交互</a></li></ol></li></ol></li></ol></nav><div class="post-body e-content"><p>隔了数月再捡起 Godot 居然觉得无所适从，找不到从何下手。<br>顿时一股悲哀从心底升起：曾几何时我也是过目不忘、学过一遍必如数家珍的选手。<br>现在变成这个 <del>B 样</del>，是谁的错呢？</p><p>虽然人老了，活还是要干的。以后还是老老实实勤做笔记吧。<br>想当年中学的时候每一个老师都不厌其烦地叨叨「好记性不如烂笔头」。<br>从「嗤之以鼻」到「有点道理」再到「不以为然」，到现在再反转，果然姜还是老的辣。</p><h2 id=技术选型><a href=#技术选型 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:技术选型 class=headings>技术选型</a></h2><p>前天（2022.4.6）刚好出了 <a href=https://godotengine.org/article/dev-snapshot-godot-4-0-alpha-6 target=_blank rel=noopener>开发者快照</a> <code>alpha 6</code>，不过跟我没关系。<br>一堆坑没填呢，真没精力开新坑了。（至少等年中 beta 再说）</p><blockquote><p>话说之前 Godot 4.0 开发进度竟然从 82% 倒退回 81%，挺乐的。<br>（关闭的 issues 没有新开的多就会这样）</p></blockquote><p>4.0 肯定是和 3.x 不兼容的——改了很多语法，重命名部分系统函数和变量。<br>好消息是官方确认会出迁移工具帮助 3.x 项目过渡到 4.0。<br>不过我估计有也不会用，毕竟我这种，啊，强迫症晚期，啊，人称重构狂魔。<br><del>Code Review 对我来说是一种享受。</del></p><p>这次用的是最新的稳定版 <code>v3.4.4.stable.official [419e713a2]</code>。</p><h2 id=参考文档><a href=#参考文档 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:参考文档 class=headings>参考文档</a></h2><span class=sticker><a href=https://docs.godotengine.org/en/stable/ target=_blank rel=noopener target=_blank><img src=https://img.shields.io/badge/Godot-官方文档-informational></a>
<a href=http://godot.pro/doc/index.html target=_blank rel=noopener target=_blank><img src=https://img.shields.io/badge/文档-中文翻译-informational></a>
<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_basics.html target=_blank rel=noopener target=_blank><img src=https://img.shields.io/badge/GDScript-语法-informational></a></span><h2 id=开发范式><a href=#开发范式 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:开发范式 class=headings>开发范式</a></h2><h3 id=代码格式><a href=#代码格式 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:代码格式 class=headings>代码格式</a></h3><p>「<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html#formatting target=_blank rel=noopener>代码格式</a>」参考 Python 的《<a href=https://www.python.org/dev/peps/pep-0008/ target=_blank rel=noopener>PEP 8 编程风格指南</a>》。</p><h3 id=命名约定><a href=#命名约定 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:命名约定 class=headings>命名约定</a></h3><p>「<a href=https://docs.godotengine.org/en/stable/tutorials/best_practices/project_organization.html target=_blank rel=noopener>文件命名</a>」考虑到项目一致性，文件命名统一使用全小写蛇形 <code>snake_case</code>。</p><blockquote><p>除非你写的是 C# 要用<ruby><rb>类名做文件名</rb><rp>（</rp><rt>ClassName</rt><rp>）</rp></ruby>，那你用大驼峰。<br>当然 场景 / 类 / 节点 的命名仍使用大驼峰，和默认的节点名格式保持一致。</p></blockquote><p>「<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html#naming-conventions target=_blank rel=noopener>变量命名</a>」就那一套，没什么可说的。</p><h3 id=代码顺序><a href=#代码顺序 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:代码顺序 class=headings>代码顺序</a></h3><p>「<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html#code-order target=_blank rel=noopener>代码顺序</a>」如下：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>tool</span>  <span class=c1># 标记为工具脚本(会在编辑器直接执行 不用运行调试器)</span>
</span></span><span class=line><span class=cl><span class=n>class_name</span>  <span class=c1># (可选)类定义</span>
</span></span><span class=line><span class=cl><span class=k>extends</span>  <span class=c1># 继承</span>
</span></span><span class=line><span class=cl><span class=c1># docstring 多行文档说明</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>signals</span>  <span class=c1># 信号</span>
</span></span><span class=line><span class=cl><span class=n>enums</span>  <span class=c1># 枚举</span>
</span></span><span class=line><span class=cl><span class=n>constants</span>  <span class=c1># 常量</span>
</span></span><span class=line><span class=cl><span class=n>exported</span> <span class=n>variables</span>  <span class=c1># 导出变量</span>
</span></span><span class=line><span class=cl><span class=n>public</span> <span class=n>variables</span>  <span class=c1># 公共变量</span>
</span></span><span class=line><span class=cl><span class=n>private</span> <span class=n>variables</span>  <span class=c1># 私有变量</span>
</span></span><span class=line><span class=cl><span class=k>onready</span> <span class=n>variables</span>  <span class=c1># 自动初始化变量</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>optional</span> <span class=n>built</span><span class=o>-</span><span class=ow>in</span> <span class=n>virtual</span> <span class=n>_init</span> <span class=n>method</span>  <span class=c1># (可选)内置的初始化虚函数</span>
</span></span><span class=line><span class=cl><span class=n>built</span><span class=o>-</span><span class=ow>in</span> <span class=n>virtual</span> <span class=n>_ready</span> <span class=n>method</span>  <span class=c1># 内置的初始化完成(节点第一次级联场景树时)虚函数</span>
</span></span><span class=line><span class=cl><span class=n>remaining</span> <span class=n>built</span><span class=o>-</span><span class=ow>in</span> <span class=n>virtual</span> <span class=n>methods</span>  <span class=c1># 其他内置的虚函数</span>
</span></span><span class=line><span class=cl><span class=n>public</span> <span class=n>methods</span>  <span class=c1># 公共方法(函数)</span>
</span></span><span class=line><span class=cl><span class=n>private</span> <span class=n>methods</span>  <span class=c1># 私有方法</span>
</span></span></code></pre></td></tr></table></div></div></div><blockquote><p>「方法」就是「函数」。一般<strong>面向对象</strong>叫 <ruby><rb>方法</rb><rp>（</rp><rt>method</rt><rp>）</rp></ruby>、<strong>面向过程</strong>叫 <ruby><rb>函数</rb><rp>（</rp><rt>function</rt><rp>）</rp></ruby>。</p></blockquote><p>这个顺序一定要背下来吗？<br>不要，谁有功夫背这个。<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/creating_script_templates.html target=_blank rel=noopener>自定义脚本模板</a>直接套就完了。<br>Windows 打开 <code>%APPDATA%\Godot\script_templates</code>，新建文本文件 <code>all_comments.gd</code>：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>extends</span> <span class=o>%</span><span class=n>BASE</span><span class=o>%</span>
</span></span><span class=line><span class=cl><span class=c1># docstring 文档说明</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Signals 信号</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Enums 枚举</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Constants 常量</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Exported variables 导出变量</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Public variables 公共变量</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Private variables 私有变量</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Onready variables 自动初始化变量</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># built-in virtual methods 内置的虚函数</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1>#func _init()%VOID_RETURN%:</span>
</span></span><span class=line><span class=cl><span class=c1>#	pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>_ready</span><span class=p>()</span><span class=o>%</span><span class=n>VOID_RETURN</span><span class=o>%</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#func _process(delta%FLOAT_TYPE%)%VOID_RETURN%:</span>
</span></span><span class=line><span class=cl><span class=c1>#	pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Public methods 公共函数</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Private methods 私有函数</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Setter/Getter methods</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl><span class=c1># Callback methods 回调函数</span>
</span></span><span class=line><span class=cl><span class=c1>################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 记得文件末尾空一行 好习惯 老生常谈了</span>
</span></span><span class=line><span class=cl><span class=c1># 我印象里起初的目的是为了兼容某些文件系统的 EOF 吞字符问题</span>
</span></span></code></pre></td></tr></table></div></div></div><h2 id=常见-q--a><a href=#常见-q--a class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:常见-q--a class=headings>常见 Q & A</a></h2><p>以下答案均来自官方文档《<a href=https://docs.godotengine.org/en/stable/tutorials/best_practices/index.html target=_blank rel=noopener>最佳实践</a>》一章。</p><h3 id=scenetree场景树和-nodetree节点树><a href=#scenetree场景树和-nodetree节点树 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:scenetree场景树和-nodetree节点树 class=headings>SceneTree（场景树）和 NodeTree（节点树）</a></h3><p>任何游戏引擎都是围绕着构建程序所用的事物抽象的。<br>在 Godot 中，游戏就是一棵由节点构成的树，树又可以结合起来构成场景。<br>然后你还可以将这些节点连起来，让它们通过信号进行通信。</p><p>游戏的所有场景都汇集在场景树（Scene Tree）中，字面意思是一棵由场景形成的树。<br>又由于场景是由一个个子节点聚合而成的，以树的形式保存为节点树（Node Tree），因此场景树也是节点树，一棵更大的节点树。</p><div class=mermaid>flowchart TD
scene_root["某个场景<br>（决战关卡）"] === scene_a["场景 A<br>（BOSS）"]
scene_root === scene_b["场景 B<br>（宝箱）"]</div><p>这是一棵（最简单的）场景树。</p><div class=mermaid>flowchart TD
scene_root["某个场景<br>（决战关卡）"] === parent(["子节点<br>（BOSS 对象实例）"])
scene_root === scene_b["场景 B<br>（宝箱）"]
subgraph scene_a["场景 A（BOSS）"]
parent === child_1(["孙节点 1<br>（BOSS 的动画）"])
parent === child_2(["孙节点 2<br>（BOSS 的音效）"])
end</div><p>这是<strong>同一棵</strong>场景树（不过是把子节点的细节显示出来了）。如上图所示：</p><ul><li>场景 A 是一棵节点树；</li><li>包含场景 A 的「某个场景」是场景树，当然更是一棵节点树。</li></ul><p>但是，从场景的角度来考虑设计游戏更容易，因为它们可以代表角色、武器、门或用户界面。<br>节点是面向 <strong>内部的业务逻辑</strong> 的，场景却是面向 <strong>实际的应用场景</strong> 的。</p><p>你可以创建任意数量的场景，用 <code>.tscn</code> 扩展名保存到硬盘上，表示「<ruby><rb>text scene</rb><rp>（</rp><rt>文本场景</rt><rp>）</rp></ruby>」。<br>（没错，Godot 最常见的 <code>.tscn</code> 文件就是「以文本形式保存或者说记录的场景」。）<br>我们把这些文件叫作「<ruby><rb>Packed Scene</rb><rp>（</rp><rt>打包场景</rt><rp>）</rp></ruby>」，因为它们将场景的内容信息进行了打包。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>var</span> <span class=n>the_scene</span> <span class=o>=</span> <span class=nb>preload</span><span class=p>(</span><span class=s2>&#34;res://packed_scene.tscn&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>instance</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>get_tree</span><span class=p>()</span><span class=o>.</span><span class=n>get_root</span><span class=p>()</span><span class=o>.</span><span class=n>add_child</span><span class=p>(</span><span class=n>the_scene</span><span class=p>)</span>  <span class=c1># 在场景树根节点手动添加某个场景</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=如何选择分辨率><a href=#如何选择分辨率 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何选择分辨率 class=headings>如何选择分辨率</a></h3><div class=table-container><table><thead><tr><th style=text-align:center>类型</th><th style=text-align:center></th><th style=text-align:center>尺寸</th><th style=text-align:center>拉伸模式</th><th style=text-align:center>拉伸比例</th></tr></thead><tbody><tr><td style=text-align:center></td><td style=text-align:center>推荐设置</td><td style=text-align:center><code>Width × Height</code></td><td style=text-align:center><code>Stretch Mode</code></td><td style=text-align:center><code>Stretch Aspect</code></td></tr><tr><td style=text-align:center>桌面游戏</td><td style=text-align:center>像素风</td><td style=text-align:center><code>256 × 224</code> ~ <code>640 × 480</code><br>取决于你用的大部分素材，比如 <code>320 × 180</code><br>（1080p 的像素就真的只是一种 <em>风格</em> 了）<br>（我只见过有插画，游戏大规模用不现实）</td><td style=text-align:center><code>viewport</code></td><td style=text-align:center><code>keep</code></td></tr><tr><td style=text-align:center>桌面游戏</td><td style=text-align:center>非像素风</td><td style=text-align:center><code>1920 × 1080</code><br><code>3840 × 2160</code>（2K）<br>（4K？独立游戏？<del>噗哧</del> 大佬右转虚幻 5 如何）<br>（有能力做 4K 的不会看本文，不会选 Godot）</td><td style=text-align:center><code>2d</code></td><td style=text-align:center><code>expand</code></td></tr><tr><td style=text-align:center>手机游戏</td><td style=text-align:center>横屏</td><td style=text-align:center><code>1280 × 720</code><br><code>1920 × 1080</code>（针对高端机型）<br>（再高没有意义，你的玩家没有写轮眼）</td><td style=text-align:center><code>2d</code></td><td style=text-align:center><code>expand</code></td></tr><tr><td style=text-align:center>手机游戏</td><td style=text-align:center>竖屏</td><td style=text-align:center><code>720 × 1080</code><br><code>1080 × 1920</code>（针对高端机型）</td><td style=text-align:center><code>2d</code></td><td style=text-align:center><code>expand</code></td></tr><tr><td style=text-align:center>应用程序</td><td style=text-align:center></td><td style=text-align:center>你想要支持的最小窗口尺寸</td><td style=text-align:center><code>disabled</code></td><td style=text-align:center><code>ignore</code></td></tr></tbody></table></div><ul><li>采用 <code>expand</code> 拉伸应该善用 <strong>布局</strong> 菜单将 Control 节点的锚点吸附到正确的位置。</li><li>不想支持异形屏（比如 16:10 的显示器，18:9 甚至 19:9 的手机）可以不用 <code>expand</code> 而是继续采用 <code>keep</code>，多余的部分会自动用黑边填充。</li><li>竖屏手游应该将 Display > Window > Handheld > Orientation 设置为 <ruby><rb>portrait</rb><rp>（</rp><rt>竖屏</rt><rp>）</rp></ruby>。</li><li>应用程序可以在脚本的 <code>_ready()</code> 函数中通过设置 <code>OS.min_window_size</code> 的值来定义窗口的最小尺寸。这样可以防止用户将应用窗口缩得过小，导致 UI 布局出现问题。</li></ul><blockquote><p>手机<strong>显示</strong>的分辨率和拍摄是两码事，哪怕 10 吋平板，超过 1080p 肉眼凡胎又能看出个什么花呢？<br>恕我直言，1440p 都 TM 是纯噱头、无效堆料。<br>你就是看得出来？（大圣收了神通吧）<del>那你跟我说干嘛，你去跟中科院说啊。</del><br>拍摄还有点说法，万一机主就是喜欢用手机拍（他买得起 RED，但他买了就是不用），拍完别说 60 吋 8K 屏，他用 IMAX 巨幕放，有钱任性爱造作，行不行？当然可以。至少物质上可以实现。</p></blockquote><h3 id=如何组织项目结构><a href=#如何组织项目结构 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何组织项目结构 class=headings>如何组织项目结构</a></h3><p>文件夹名和文件名，<ruby><rb>必须</rb><rp>（</rp><rt>must</rt><rp>）</rp></ruby>小写，<ruby><rb>尽量</rb><rp>（</rp><rt>should</rt><rp>）</rp></ruby>在适当的时候使用复数形式。</p><p>举例（自用项目组织）：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash><span class=line><span class=cl>game/
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├── assets/                 <span class=c1># 资源</span>
</span></span><span class=line><span class=cl>│ ├── images/
</span></span><span class=line><span class=cl>│ └── sounds/
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├── docs/                   <span class=c1># 文档</span>
</span></span><span class=line><span class=cl>│ ├── .gdignore             <span class=c1># 有这个名字的文件则此目录所有内容(包括二级子目录)都会被忽略</span>
</span></span><span class=line><span class=cl>│ ├── learning.html
</span></span><span class=line><span class=cl>│ ├── README.md
</span></span><span class=line><span class=cl>│ └── ...
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├── src/                    <span class=c1># 源码</span>
</span></span><span class=line><span class=cl>│ ├── characters/           <span class=c1># 角色</span>
</span></span><span class=line><span class=cl>│ │ ├── enemies/
</span></span><span class=line><span class=cl>│ │ ├── npcs/
</span></span><span class=line><span class=cl>│ │ └── player/
</span></span><span class=line><span class=cl>│ ├── levels/               <span class=c1># 关卡</span>
</span></span><span class=line><span class=cl>│ │ ├── world_01/
</span></span><span class=line><span class=cl>│ │ │ ├── w1_level_01.gd
</span></span><span class=line><span class=cl>│ │ │ ├── w1_level_01.tscn
</span></span><span class=line><span class=cl>│ │ │ ├── w1_level_02.gd
</span></span><span class=line><span class=cl>│ │ │ ├── w1_level_02.tscn
</span></span><span class=line><span class=cl>│ │ │ └── ...
</span></span><span class=line><span class=cl>│ │ ├── world_02/
</span></span><span class=line><span class=cl>│ │ └── ...
</span></span><span class=line><span class=cl>│ ├── models/               <span class=c1># 模型</span>
</span></span><span class=line><span class=cl>│ │ ├── forest/
</span></span><span class=line><span class=cl>│ │ │ ├── bush.tscn
</span></span><span class=line><span class=cl>│ │ │ ├── tree.tscn
</span></span><span class=line><span class=cl>│ │ │ ├── grass.gd
</span></span><span class=line><span class=cl>│ │ │ ├── grass.tscn
</span></span><span class=line><span class=cl>│ │ │ └── ...
</span></span><span class=line><span class=cl>│ │ ├── town/
</span></span><span class=line><span class=cl>│ │ │ ├── house.tscn
</span></span><span class=line><span class=cl>│ │ │ ├── house_door.gd
</span></span><span class=line><span class=cl>│ │ │ ├── house_door.tscn
</span></span><span class=line><span class=cl>│ │ │ └── ...
</span></span><span class=line><span class=cl>│ │ └── ...
</span></span><span class=line><span class=cl>│ └── ...
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└── project.godot           <span class=c1># 项目基础文件(定位项目根目录)</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=如何切换场景><a href=#如何切换场景 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何切换场景 class=headings>如何切换场景</a></h3><h4 id=手动更换场景><a href=#手动更换场景 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:手动更换场景 class=headings>手动更换场景</a></h4><div class=table-container><table><thead><tr><th style=text-align:center>多种实现方式</th><th style=text-align:center>方式</th><th style=text-align:center>是否继续处理</th><th style=text-align:center>缺点</th></tr></thead><tbody><tr><td style=text-align:center>删除现有场景</td><td style=text-align:center>1. <code>SceneTree.change_scene()</code><br>2. <code>SceneTree.change_scene_to()</code><br>3. <code>get_node("/root/Main").free()</code><br>删除整个主场景</td><td style=text-align:center>卸载内存</td><td style=text-align:center>回到此场景变得更昂贵<br>（重新加载需要时间和内存）</td></tr><tr><td style=text-align:center>隐藏现有场景</td><td style=text-align:center>更改节点的可见性和碰撞检测<br>从游戏角色的角度隐藏整个节点子树</td><td style=text-align:center>处理继续</td><td style=text-align:center>增加不必要的负载</td></tr><tr><td style=text-align:center>分离现有场景</td><td style=text-align:center><code>Node.remove_child(Node)</code><br>将此场景从场景树上分离<br>类似其他引擎里的禁用（disable）</td><td style=text-align:center>仍在内存中<br>但处理停止</td><td style=text-align:center>如果场景树中存在数据更新<br>则此场景里的数据会变得过时</td></tr></tbody></table></div><blockquote><p>小地图功能或本地多人分屏游戏可以使用 <a href=https://docs.godotengine.org/en/stable/classes/class_viewportcontainer.html#class-viewportcontainer target=_blank rel=noopener><code>ViewportContainer</code></a> 来同时显示多个不同的场景。</p></blockquote><h4 id=直接切换场景树><a href=#直接切换场景树 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:直接切换场景树 class=headings>直接切换场景树</a></h4><p>对于小型游戏，一个更简易的选择是使用一个游戏单例；<br>然后用 <a href=https://docs.godotengine.org/en/stable/classes/class_scenetree.html#class-scenetree-method-change-scene target=_blank rel=noopener><code>SceneTree.change_scene()</code></a> 直接切换游戏的主场景（舞台）。</p><p>不过这种方式需要注意 GUI 的额外处理，可以选用以下任一方式：</p><ul><li>GUI 也是单例</li><li>将 GUI 包含在世界中</li><li>手动添加到根节点的子节点</li></ul><p>否则 GUI 会在场景转换时自行删除。</p><h3 id=何时使用场景与脚本><a href=#何时使用场景与脚本 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:何时使用场景与脚本 class=headings>何时使用场景与脚本</a></h3><p>正如本章一开始就讲过了：Godot 说的「场景」一般泛指的 <code>.tscn</code> 文件，其本质就是打包好的场景（Packed Scene）而已。理论上只用纯脚本就可以实现场景的所有功能。<br>那么在既可以用脚本包也可以用场景的情况下，什么时候应该选用脚本呢？</p><h4 id=从性能方面考虑><a href=#从性能方面考虑 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:从性能方面考虑 class=headings>从性能方面考虑</a></h4><ul><li>脚本每条指令都要调用脚本 API，导致后端要进行多次 「查找」，以找到要执行的逻辑。</li><li>场景定义了使用序列化数据创建对象的资源。<br>引擎可以在后端批量处理场景，并提供比脚本好得多的性能。</li></ul><p>也就是说：<strong>场景包的速度比脚本快；游戏越大，越应该选用场景包。</strong></p><h4 id=从易用性方面考虑><a href=#从易用性方面考虑 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:从易用性方面考虑 class=headings>从易用性方面考虑</a></h4><details class=collapse open><summary>使用脚本添加一个节点</summary><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>extends</span> <span class=ne>Node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>_init</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>child</span> <span class=o>=</span> <span class=ne>Node</span><span class=o>.</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>child</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;Child&#34;</span>
</span></span><span class=line><span class=cl>	<span class=n>child</span><span class=o>.</span><span class=n>script</span> <span class=o>=</span> <span class=nb>preload</span><span class=p>(</span><span class=s2>&#34;Child.gd&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>child</span><span class=o>.</span><span class=n>owner</span> <span class=o>=</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>	<span class=n>add_child</span><span class=p>(</span><span class=n>child</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div></details><details class=collapse><summary>使用场景添加一个节点</summary><p>点击加号，选中要添加的节点，点击确定。</p></details><h4 id=从稳定性方面考虑><a href=#从稳定性方面考虑 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:从稳定性方面考虑 class=headings>从稳定性方面考虑</a></h4><p>实际使用过程中勾选一个选项 / 改变一个数值很容易，但你很难「不小心」删掉一整行代码。<br>这是好处也是坏处，是优势也是劣势：</p><ul><li>「创造」过程中，采用 <strong>脚本</strong> 写代码一字一句交代得清清楚楚显然更保险；</li><li>「使用」过程中，采用 <strong>场景</strong> 来修改提供现成的可配置项对于 <em>节点本身</em> 的破坏性显然更小。</li></ul><p>因此得出下列结论。</p><h4 id=结论><a href=#结论 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:结论 class=headings>结论</a></h4><ul><li>如果想创建一个基本工具，会在不同的项目中重用，可能会提供给不同技能水平的人（包括那些不认为自己是程序员的人），那么它应该是一个脚本，最好有一个自定义名称 / 图标。</li><li>如果想创建一个基于本游戏特有的概念，那么它应该是一个场景，场景比脚本更容易跟踪 / 编辑（毕竟可视化），而且更安全（出错的概率更小*），最后性能也更高。</li></ul><blockquote><p>* 众所周知，开发过程中最大的安全隐患是「你」，你就是一个人形 bug 制造机。<br>你会受到体力（生理）/ 精力（心理）以及来自外界环境的各种负面影响，堪称极其不稳定。<br><del>血肉苦弱，有机体。</del> 如果有得选，尽量不要给自己任何犯错的机会。</p></blockquote><p>至于那些仅用场景无法实现的功能，当然是正常写脚本了（你想用场景也不能够啊）。<br>（说起来一个游戏真正的精华，灵魂所在，往往是这些引擎本身的接口提供不了的功能。）</p><h3 id=_processdelta-和-_physics_processdelta-该用哪个><a href=#_processdelta-和-_physics_processdelta-该用哪个 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:_processdelta-和-_physics_processdelta-该用哪个 class=headings><code>_process(delta)</code> 和 <code>_physics_process(delta)</code> 该用哪个</a></h3><p>游戏是使用循环来运行的。每一帧，你都需要先更新游戏世界的状态，再把它画到屏幕上。<br>刷新画面的每一帧怎么来的？当然是运算出来的。<br>依赖于这个「刷新画面」的帧——我称之为前端渲染帧，<ruby><rb>即俗称的 FPS</rb><rp>（</rp><rt>Frames Per Second</rt><rp>）</rp></ruby>——<br>就是 <code>_process()</code> 处理数据的时机。</p><p>无论渲染时间长短（进而导致<ruby><rb>渲染帧速率</rb><rp>（</rp><rt>FPS / 帧数</rt><rp>）</rp></ruby>高低），随着现实时间的推移同步进行一致性更新的（我称之为后端物理帧）——就是 <code>_physics_process()</code> 处理数据的时机。</p><p>而 <code>delta</code> 这个参数表示 <ruby><rb>deltatime</rb><rp>（</rp><rt>增量时间</rt><rp>）</rp></ruby>（$ \Delta t $），指「上一帧到这一帧经过的时间」。<br>通过 deltatime 动态调整游戏的表现，就能做到（避免 <em>掉帧</em> 发生）：<br>无论游戏后端运算速率的快慢，最后展现出来玩家感受到的观感是平滑且一致的。</p><ul><li>前端渲染帧越高越好；越高表示画面刷新速率越快、频率越高，画面响应越及时。<br>前端渲染帧可能随着时间、设备的不同而不同。</li><li>后端物理帧变化越小越好；变化越小表示游戏运行得越稳定。<br>后端物理帧会努力维持在一个固定的频率*。</li></ul><blockquote><p>* 后端物理帧在默认设置下恒定为一秒 60 帧。（以格斗游戏为典型的大部分游戏都是 60 帧）<br>你可以在 Project Settings > Physics > Common > Physics Fps 设置这个值。</p></blockquote><p>任何和物理运算（比如运动和碰撞）相关的行为都应该在 <code>_physics_process()</code> 中处理，比如角色的移动速度 / 子弹的弹道速度等等。</p><ul><li>大部分时候都应该将速度乘以 deltatime；<br>否则游戏一卡顿就会导致判定出现异常（它理应已抵达那里，但实际上却尚未到达那里）。</li><li>有时加速度也应该乘以 deltatime；<br>否则可能出现类似坠落前 90 米掉落用了 0.9 秒，最后 10 米却用了 10 秒的怪异情形。</li></ul><p>很多玩家司空见惯的 bug 背后就是这么简单的原理。</p><blockquote><p>以上只是范式，很多游戏并没有这样做；有些是没有顾及到，有些是不在乎，有些甚至是故意为之。<br>比如跑毒图的都知道 GTA5 就是物理和渲染帧挂钩的：同一辆车，FPS 越高极限速度就越快。<br>也许 R 星认为当画面掉帧时应该让操作一起卡顿对玩家来说才更公平。<br>（没有嘲讽的意思，你细想是有它的道理在的。涉及到输入反馈等多方面的游戏体验优化问题）</p></blockquote><hr><p>如果只是需要一个一直运行，但不需要像 <code>_process()</code> 或 <code>_physics_process()</code> 频率那么高的逻辑检查和数据缓存循环，可以利用计时器实现：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>while</span> <span class=bp>true</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>my_method</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=o>$</span><span class=ne>Timer</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>  <span class=c1># Timer 节点设置为 1 / 2.5 / 10 秒就随你高兴了</span>
</span></span><span class=line><span class=cl>	<span class=nb>yield</span><span class=p>(</span><span class=o>$</span><span class=ne>Timer</span><span class=p>,</span> <span class=s2>&#34;timeout&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1># 这里确实需要, 其他非必要情况不推荐使用 yield, 能用信号实现就尽量用信号替代</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=_inputevent-和-_unhandled_inputevent-该用哪个><a href=#_inputevent-和-_unhandled_inputevent-该用哪个 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:_inputevent-和-_unhandled_inputevent-该用哪个 class=headings><code>_input(event)</code> 和 <code>_unhandled_input(event)</code> 该用哪个</a></h3><p>两者都可以用来接收并处理单独的输入事件。二者的区别在于：如果按键、鼠标点击等事件没有被 <code>_input()</code> 回调或用户界面组件处理，<code>_unhandled_input()</code> 方法才会收到这个事件。</p><p>游戏中的输入通常是使用 <code>_unhandled_input()</code> 处理的。<br>而 <code>_input()</code> 回调可以用来在 <code>_unhandled_input()</code> 获取前拦截并处理输入事件*。</p><blockquote><p>* 比如鼠标输入就应该尽量使用 <code>_input()</code> 而不是 <code>_unhandled_input()</code>，以免被奇奇怪怪的 UI 组件拦截进而导致操作失灵。</p></blockquote><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>func</span> <span class=n>_unhandled_input</span><span class=p>(</span><span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>match</span> <span class=n>event</span><span class=o>.</span><span class=n>get_class</span><span class=p>():</span>
</span></span><span class=line><span class=cl>		<span class=s2>&#34;InputEventKey&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=ne>Input</span><span class=o>.</span><span class=n>is_action_just_pressed</span><span class=p>(</span><span class=s2>&#34;ui_accept&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>				<span class=nb>print</span><span class=p>(</span><span class=n>get_process_delta_time</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div></div><p>为了保证最佳性能，尽可能避免在上面说的 <code>_process()</code> 或 <code>_physics_process()</code> 里高频率轮询检查玩家输入——不管实际有没有输入，它们都会触发检查（浪费巨量资源）。<br>而 <code>_input()</code> 或 <code>_unhandled_input()</code> 只会在引擎实际检测到存在输入的帧上触发。</p><p>当然了，如果的确需要 deltatime 的话，你可以根据实际需求来获取对应的 deltatime。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>func</span> <span class=n>_process</span><span class=p>(</span><span class=n>delta</span><span class=p>):</span>  <span class=c1># 或者 _physics_process, 具体区别详见上一节</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=ne>Input</span><span class=o>.</span><span class=n>is_action_just_pressed</span><span class=p>(</span><span class=s2>&#34;ui_select&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=n>delta</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=单例自动加载-autoload什么时候用><a href=#单例自动加载-autoload什么时候用 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:单例自动加载-autoload什么时候用 class=headings>单例（自动加载 <code>autoload</code>）什么时候用</a></h3><p>Godot 的场景系统虽然强大而灵活，但有一个缺点：无法保存多个场景都需要的信息。<br>具体来说：玩家得分、背包 / 仓库、永久属性、持有货币、阵营声望……等等。</p><p>你当然可以通过一些变通方法来解决此问题，但是它们有其自身的局限性：</p><ul><li>可以把需要的数据当成子节点来加载和卸载；<br>然而，这就意味着产生了不健康的强耦合关系——如果缺失了数据，这些场景就无法再独立正常运行。</li><li>可以把需要的数据存储到硬盘里的 <code>user://</code> 目录（类似存档文件），谁需要就自行读取；<br>可是频繁地读写文件是一件很麻烦也很耗资源的事，甚至可能拖累游戏运行速度。</li></ul><h4 id=什么是-godot-的单例><a href=#什么是-godot-的单例 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:什么是-godot-的单例 class=headings>什么是 Godot 的单例</a></h4><p>单例就是解决「在多个场景之间持久存储数据」的常见用例的实用工具。<br>利用单例，你可以实现：</p><ul><li>无论当前运行哪个场景，始终加载。因此可以用来切换场景和处理场景之间的过渡。</li><li>存储全局变量（比如玩家信息），因为 GDScript 在设计上就不支持全局变量。</li></ul><blockquote><p>需要注意的是 Godot 中的单例比较特殊，只是「行为」类似我们一般所说的「单例设计模式」中的那种「真」单例。也就是说，如果你确实需要，你<strong><ruby><rb>可以</rb><rp>（</rp><rt>may</rt><rp>）</rp></ruby></strong>把 Godot 的单例多次实例化。</p></blockquote><h4 id=godot-里单例的实际用法><a href=#godot-里单例的实际用法 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:godot-里单例的实际用法 class=headings>Godot 里单例的实际用法</a></h4><p>你可以设置 <ruby><rb>自动加载</rb><rp>（</rp><rt>AutoLoad</rt><rp>）</rp></ruby> 来加载「场景包」或「继承自 Node 节点（<code>extends Node</code>）的脚本」。<br>比方说「Path」为 <code>res://player_variables.gd</code>，「Node Name」为 <code>PlayerVariables</code>。<br>这意味着，任何节点都可以访问并使用一个名为 <code>PlayerVariables</code> 的单例：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>var</span> <span class=n>player_vars</span> <span class=o>=</span> <span class=n>get_node</span><span class=p>(</span><span class=s2>&#34;/root/PlayerVariables&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>player_vars</span><span class=o>.</span><span class=n>health</span> <span class=o>-=</span> <span class=mi>10</span>
</span></span></code></pre></td></tr></table></div></div></div><p>如果你还勾选了<strong><ruby><rb>启用</rb><rp>（</rp><rt>Enable</rt><rp>）</rp></ruby></strong>（默认勾选），那么就可以直接访问该单例而不需要通过 <code>get_node()</code>：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=n>PlayerVariables</span><span class=o>.</span><span class=n>health</span> <span class=o>-=</span> <span class=mi>10</span>
</span></span></code></pre></td></tr></table></div></div></div><h4 id=应该在什么时机使用单例><a href=#应该在什么时机使用单例 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:应该在什么时机使用单例 class=headings>应该在什么时机使用单例</a></h4><p>举个实际的例子：切割音频问题。</p><p>假设我们正在制作一个平台跳跃类游戏（类似超级马里奥），希望收集金币时能够播放音效。<br>如果使用 <code>AudioStreamPlayer</code> 节点，当正在播放音效时调用它，新的声音就会打断第一个声音。</p><p>有一个堪称一劳永逸的解决方案——写一个全局的、能够自动加载的类（音效管理器）。<br>它会生成一个 <code>AudioStreamPlayers</code> 的节点池，每次新的音效播放请求出现就添加到节点池里开始播放。假如取名为 <code>Sound</code>，你可以在项目的任何地方使用 <code>Sound.play("coin_pickup.ogg")</code> 之类的方式轻松调用，听起来很美好是吧。</p><p>短期来看，这确实解决了问题；但与此同时，它带来了更多更大的麻烦。</p><ul><li><strong>全局对象</strong>：整个项目<strong>每一个</strong>需要声音的地方现在都<strong>强依赖</strong>于这个音效类。假如一个音效有错误，或者找不到一个可用 <code>AudioStreamPlayer</code>，那么一切都会崩溃，<strong>一切</strong>。</li><li><strong>全局访问</strong>：任何对象都可以从<strong>任何地方</strong>调用 <code>Sound.play(sound_path)</code>。如果你发现有一个音效有错，你对于它具体在什么位置完全<ruby><rb>是毫无头绪</rb><rp>（</rp><rt>have no idea</rt><rp>）</rp></ruby>，你必须漫山遍野地去排查<strong>每一个</strong>可能出错的地方。</li><li><strong>全局资源占用</strong>：由于从游戏启动之始就维护了一个 <code>AudioStreamPlayer</code> 节点池，你不知道该如何控制数量——太少会出现 bug（被吞掉而没有播放成功的音效），太多则会占用更多其实根本没必要占用的内存。</li></ul><p>将使用音效的场景的 <code>AudioStreamPlayer</code> 尽可能保留在其内部，以上问题都会消失。</p><ul><li>每个场景管理自己的状态信息，如果数据有问题，只会在该场景<ruby><rb>内部出现问题</rb><rp>（</rp><rt>死道友不死贫道</rt><rp>）</rp></ruby>。</li><li>每个场景只会访问自己的节点，如果出现一个和它相关的 bug，不用找了，必然是它。</li><li>每个场景占用的内存按需分配（<del>少份多次</del>）；而且在不再需要时可以直接从内存中卸载掉。</li></ul><blockquote><p>然后会碰到一个问题：音效可能放不完——当金币被吃掉的时候播放音效，而音效还没放完可能整个金币节点就被 <code>queue_free()</code> 释放掉了。这里提两个解决方案：</p><ol><li>金币被吃的时候<ruby><rb>现</rb><rp>（</rp><rt>临时</rt><rp>）</rp></ruby>创建一个新的 <code>AudioStreamPlayer</code> 节点并挂载到根节点再播放，放完清理。<br>（音效不像图形会「错位」，随便在哪放都是同样效果。<del>总不可能从邻居的蓝牙音箱放出来吧</del>）</li><li>金币被吃的时候隐藏金币的图像和碰撞体，启动音效播放器，播放完毕后再释放整个金币节点。</li></ol></blockquote><p>讲清楚了为什么应该谨慎使用单例（自动加载），现在说说到底怎么用才不算乱用：</p><ul><li><strong>静态数据</strong>：如果你需要某个类专属的数据，比如数据库，那么自动加载很合适。<br>因为 Godot 中并没有脚本 API 来创建和管理静态数据。</li><li><strong>静态函数</strong>：创建一个只返回值的函数库（工具类）。</li><li><strong>范围广泛的系统</strong>：如果一个类只管理自己的信息，而不会掺杂其他对象的数据。<br>而且这个信息可能到处都会访问，那么使用单例是一个好主意，比如任务 / 对话系统。</li></ul><p>一句话：有一个游戏系统 1. 自己管自己（的数据）；2. 全局可访问；3. 独立存在。<br>这个系统就是单例（自动加载）没跑了。</p><h3 id=如何快速调试使用-tool-工具脚本预览代码效果><a href=#如何快速调试使用-tool-工具脚本预览代码效果 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何快速调试使用-tool-工具脚本预览代码效果 class=headings>如何快速调试（使用 <code>tool</code> 工具脚本预览代码效果）</a></h3><p>将 <code>tool</code> 关键字放在任何 GDScript 文件的顶部，它将在编辑器中运行。<br>用<a href=https://docs.godotengine.org/en/stable/tutorials/plugins/running_code_in_the_editor.html target=_blank rel=noopener>官方文档</a>的话说：「这使您可以导入和导出插件，创建自定义级别编辑器之类的插件，或使用与项目中使用的相同的节点和 API 来创建脚本。」</p><p>我没当成脚本；我是当成「即时可见的调试器」（所见即所得）用的。不过需要注意两点：</p><ol><li>如果你写了 bug，由于立刻运行，bug 会传染给编辑器，可能导致编辑器崩溃。<br>（比如涉及 <code>queue_free()</code>，一定要<strong>极其谨慎</strong>，小心再小心。）<br>解决方案：主要逻辑写完测过没问题再在文件开头加上 tool 慢慢<del>调教</del> 调试。</li><li>如果你状态不太好（加班太久神智不清），可能会忘记编辑器和实际运行之间是有区别的。<br>（然后你 debug 半天死活没有效果差点疯掉，最后发现是编辑器和游戏的代码弄混了。）<br>解决方案：把在编辑器中运行的代码和在游戏中运行的代码分开，如下所示。</li></ol><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>func</span> <span class=n>_process</span><span class=p>(</span><span class=n>delta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>Engine</span><span class=o>.</span><span class=n>editor_hint</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;现在在编辑器中&#34;</span><span class=p>,</span> <span class=n>delta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;现在在游戏中&#34;</span><span class=p>,</span> <span class=n>delta</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=如何自定义数据结构><a href=#如何自定义数据结构 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何自定义数据结构 class=headings>如何自定义数据结构</a></h3><p>并不是任何事都必须用 Node 节点来完成；比如自定义数据结构，使用 Object 扩展即可。</p><p>给大家简单表演一个链表助助兴吧：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=c1># linked_list.gd</span>
</span></span><span class=line><span class=cl><span class=k>extends</span> <span class=ne>Object</span>
</span></span><span class=line><span class=cl><span class=n>class_name</span> <span class=n>LinkedList</span>  <span class=c1># 定义 class_name 后 本类会被视为全局变量 直接用就完了</span>
</span></span><span class=line><span class=cl><span class=c1># 简单的链表实现</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=n>LinkedListNode</span><span class=p>:</span>  <span class=c1># 链表节点内部类</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>value</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>next</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>func</span> <span class=n>_init</span><span class=p>(</span><span class=n>p_value</span><span class=p>,</span> <span class=n>p_next</span> <span class=o>=</span> <span class=n>null</span><span class=p>):</span>  <span class=c1># 递归结构</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=n>p_value</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>p_next</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>var</span> <span class=n>head</span> <span class=o>=</span> <span class=n>null</span>  <span class=c1># 单向链表头部</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>_init</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=n>LinkedListNode</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>find_node</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>  <span class=c1># 寻找节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>current</span> <span class=ow>and</span> <span class=n>current</span><span class=o>.</span><span class=n>value</span> <span class=o>!=</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>current</span> <span class=o>==</span> <span class=n>null</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Node &#34;</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=s2>&#34; not found!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Node &#34;</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=s2>&#34; found.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>current</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>insert_after</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>new_value</span><span class=p>):</span>  <span class=c1># 插入节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>new_node</span> <span class=o>=</span> <span class=n>LinkedListNode</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>new_value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>find_node</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>new_node</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=n>current</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>new_node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>append</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>  <span class=c1># 在尾部添加节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>new_node</span> <span class=o>=</span> <span class=n>LinkedListNode</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=n>current</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>new_node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>prepend</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>  <span class=c1># 在头部添加节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>new_node</span> <span class=o>=</span> <span class=n>LinkedListNode</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>new_node</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=n>new_node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>remove</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>  <span class=c1># 移除指定节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>previous_node</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>current</span> <span class=ow>and</span> <span class=n>current</span><span class=o>.</span><span class=n>value</span> <span class=o>!=</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>previous_node</span> <span class=o>=</span> <span class=n>current</span>
</span></span><span class=line><span class=cl>		<span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>current</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>previous_node</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>remove_head</span><span class=p>():</span>  <span class=c1># 移除头部节点</span>
</span></span><span class=line><span class=cl>	<span class=bp>self</span><span class=o>.</span><span class=n>head</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>remove_tail</span><span class=p>():</span>  <span class=c1># 移除尾部节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>previous_node</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>current</span> <span class=ow>and</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>previous_node</span> <span class=o>=</span> <span class=n>current</span>
</span></span><span class=line><span class=cl>		<span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=n>previous_node</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>traverse</span><span class=p>():</span>  <span class=c1># 遍历节点</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>current</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>head</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>temp</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=n>current</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>temp</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=n>current</span><span class=o>.</span><span class=n>value</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>		<span class=n>current</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>next</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>temp</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><blockquote><p>如果是继承节点（<code>extends Node</code>）的脚本定义了 <code>class_name</code> 还会自动加入节点列表。</p></blockquote><p>单元测试：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=c1># main.gd</span>
</span></span><span class=line><span class=cl><span class=k>extends</span> <span class=ne>Node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>_ready</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=k>var</span> <span class=n>linked_list</span> <span class=o>=</span> <span class=n>LinkedList</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 不需要额外引入 直接用即可 原因上面讲过了</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 1, 2, 3, 4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>insert_after</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 1, 2, 5, 3, 4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>prepend</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 6, 1, 2, 5, 3, 4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 6, 1, 2, 5, 4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>remove_head</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 1, 2, 5, 4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>remove_tail</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>traverse</span><span class=p>()</span>  <span class=c1># 1, 2, 5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>find_node</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>linked_list</span><span class=o>.</span><span class=n>find_node</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><p>预期结果：</p><pre tabindex=0><code>1 2 3 4
Node 2 found.
1 2 5 3 4
6 1 2 5 3 4
6 1 2 5 4
1 2 5 4
1 2 5
Node 2 found.
Node 3 not found!
</code></pre><p>这里只是简单演示一下用法，如何做内存管理、甚至扩展成 <code>双向循环链表</code> 此处不再赘述。</p><blockquote><p>Object 不管理内存，如果类继承自 Object，必须手动删除（<code>free</code>）它的实例来释放内存。</p></blockquote><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-GDScript data-lang=GDScript><span class=line><span class=cl><span class=k>extends</span> <span class=ne>Object</span>
</span></span><span class=line><span class=cl><span class=n>class_name</span> <span class=n>TreeNode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>var</span> <span class=n>_parent</span> <span class=p>:</span> <span class=n>TreeNode</span> <span class=o>=</span> <span class=n>null</span>
</span></span><span class=line><span class=cl><span class=k>var</span> <span class=n>_children</span> <span class=p>:</span> <span class=o>=</span> <span class=p>[]</span> <span class=k>setget</span>  <span class=c1># TODO 这里写 setter 和 getter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>func</span> <span class=n>_notification</span><span class=p>(</span><span class=n>p_what</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>match</span> <span class=n>p_what</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>NOTIFICATION_PREDELETE</span><span class=p>:</span>  <span class=c1># 手动实现析构函数</span>
</span></span><span class=line><span class=cl>			<span class=k>for</span> <span class=n>a_child</span> <span class=ow>in</span> <span class=n>_children</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=n>a_child</span><span class=o>.</span><span class=n>free</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></div><p>同理，<code>队列</code>、<code>栈</code>、<code>堆</code>、<code>二叉搜索树</code> / <code>红黑树</code> / <code>散列树</code> / 各种 <code>树</code>、各种 <code>图</code>、不相交集……<br>无论何种数据结构，只要你想，你做就完了。<br>GDScript 是一门具有自举能力的独立编程「语言」。</p><blockquote><p>Godot 就是用 GDScript 写的，编辑器本身其实就是一个 Godot 游戏。</p></blockquote><p>除了 <a href=https://docs.godotengine.org/en/stable/classes/class_object.html#class-object target=_blank rel=noopener>Object</a> 之外，你还可以使用 <a href=https://docs.godotengine.org/en/stable/classes/class_reference.html#class-reference target=_blank rel=noopener>Reference</a>，如果你不想手动进行内存管理的话。<br>Reference 会跟踪对自己的引用，只有当对自己没有另外的引用存在时，才会删除加载的内存。
（除此之外跟 Object 没啥区别。<code>Tree</code> 节点就是 Object，<code>File</code> 对象就是 Reference。）</p><p>如果你想将数据结构保存为文件，可以再进一步使用 <a href=https://docs.godotengine.org/en/stable/classes/class_resource.html#class-resource target=_blank rel=noopener>Resource</a>。<br>它们天然具有将其对象属性，序列化和反序列化 Godot 资源文件的能力。<br>（用人话说：以文件形式保存和加载。脚本 <code>.gd</code> 和场景包 <code>.tscn</code> 其实就是 Resource。）<br>具体用法可以参考「<a href=https://docs.godotengine.org/en/stable/tutorials/scripting/resources.html#creating-your-own-resources target=_blank rel=noopener>创建自己的资源</a>」。</p><h3 id=如何应用面向对象原则><a href=#如何应用面向对象原则 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:如何应用面向对象原则 class=headings>如何应用面向对象原则</a></h3><p>如果可能的话，应该尽量设计没有依赖性的场景。<br>你应该创建场景，而场景将所需的一切保留在其内部。</p><p>另外设计项目架构时可以思考以下几个问题：</p><h4 id=聚合-or-组合><a href=#聚合-or-组合 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:聚合-or-组合 class=headings>聚合 or 组合</a></h4><ul><li>聚合：简单地聚在一起，彼此之间并不直接依赖。</li><li>组合：除了聚在一起之外，还进一步互相连接彼此，进而形成一个整体。</li></ul><h4 id=继承-or-构造><a href=#继承-or-构造 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:继承-or-构造 class=headings>继承 or 构造</a></h4><ul><li>继承：全盘接受父类的一切，并在此基础上扩展自己的特有功能。</li><li>构造：想象一堆拼到一半的乐高积木，你可以选择自己想要的不同部件组成特定的整体。</li></ul><h4 id=场景如何与外部环境交互><a href=#场景如何与外部环境交互 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:场景如何与外部环境交互 class=headings>场景如何与外部环境交互</a></h4><p>一句话：向下调用（善用 <code>$</code>），向上信号。<br>具体应用可以参考官方文档对 <a href=https://docs.godotengine.org/en/stable/tutorials/best_practices/scene_organization.html#how-to-build-relationships-effectively target=_blank rel=noopener>依赖注入</a> 设计模式的实现。</p></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>作者</span>：<a href=https://ews.ink/ class="p-author h-card" target=_blank rel=noopener>time2beat</a></li><li class="copyright-item link"><span class=copyright-item-text>链接</span>：<a href=/tech/game-godot-review-1-prepare/ target=_blank rel=noopener>https://ews.ink/tech/game-godot-review-1-prepare/</a></li><li class="copyright-item license"><span class=copyright-item-text>许可</span>：<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a></li></ul></article><div class=updated-badge-container><span title="Updated @2022-04-20 13:24:53 CST" style=cursor:help><svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2022-04-20</text><text x="915" y="140" textLength="650" transform="scale(.1)">2022-04-20</text></g></svg></span></div><div class=post-share><div class=share-items><div class="share-item twitter"><a href="https://twitter.com/share?url=https://ews.ink/tech/game-godot-review-1-prepare/&text=%e5%a4%8d%e4%b9%a0%20Godot%20%e5%bc%80%e5%8f%91%e6%b5%81%e7%a8%8b%20%e5%85%b6%e4%b8%80%20%e5%89%8d%e6%9c%9f%e5%87%86%e5%a4%87&hashtags=Godot,&via=%25!s%28%3cnil%3e%29" title=分享到「Twitter」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></div><div class="share-item facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://ews.ink/tech/game-godot-review-1-prepare/&hashtag=%23Godot" title=分享到「Facebook」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon facebook-icon"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></a></div><div class="share-item linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ews.ink/tech/game-godot-review-1-prepare/&title=%e5%a4%8d%e4%b9%a0%20Godot%20%e5%bc%80%e5%8f%91%e6%b5%81%e7%a8%8b%20%e5%85%b6%e4%b8%80%20%e5%89%8d%e6%9c%9f%e5%87%86%e5%a4%87&summary=%e9%9a%94%e4%ba%86%e6%95%b0%e6%9c%88%e5%86%8d%e6%8d%a1%e8%b5%b7%20Godot%20%e5%b1%85%e7%84%b6%e8%a7%89%e5%be%97%e6%97%a0%e6%89%80%e9%80%82%e4%bb%8e%ef%bc%8c%e6%89%be%e4%b8%8d%e5%88%b0%e4%bb%8e%e4%bd%95%e4%b8%8b%e6%89%8b%e3%80%82%20%e9%a1%bf%e6%97%b6%e4%b8%80%e8%82%a1%e6%82%b2%e5%93%80%e4%bb%8e%e5%bf%83%e5%ba%95%e5%8d%87%e8%b5%b7%ef%bc%9a%e6%9b%be%e5%87%a0%e4%bd%95%e6%97%b6%e6%88%91%e2%80%a6%e2%80%a6&source=Everybody%20Wants%20Some" title=分享到「LinkedIn」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a></div><div class="share-item telegram"><a href="https://t.me/share/url?url=https://ews.ink/tech/game-godot-review-1-prepare/&text=%e5%a4%8d%e4%b9%a0%20Godot%20%e5%bc%80%e5%8f%91%e6%b5%81%e7%a8%8b%20%e5%85%b6%e4%b8%80%20%e5%89%8d%e6%9c%9f%e5%87%86%e5%a4%87" title=分享到「Telegram」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon telegram-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a></div><div class="share-item qq"><a href="https://connect.qq.com/widget/shareqq/index.html?url=https://ews.ink/tech/game-godot-review-1-prepare/&title=%e5%a4%8d%e4%b9%a0%20Godot%20%e5%bc%80%e5%8f%91%e6%b5%81%e7%a8%8b%20%e5%85%b6%e4%b8%80%20%e5%89%8d%e6%9c%9f%e5%87%86%e5%a4%87&summary=%e9%9a%94%e4%ba%86%e6%95%b0%e6%9c%88%e5%86%8d%e6%8d%a1%e8%b5%b7%20Godot%20%e5%b1%85%e7%84%b6%e8%a7%89%e5%be%97%e6%97%a0%e6%89%80%e9%80%82%e4%bb%8e%ef%bc%8c%e6%89%be%e4%b8%8d%e5%88%b0%e4%bb%8e%e4%bd%95%e4%b8%8b%e6%89%8b%e3%80%82%20%e9%a1%bf%e6%97%b6%e4%b8%80%e8%82%a1%e6%82%b2%e5%93%80%e4%bb%8e%e5%bf%83%e5%ba%95%e5%8d%87%e8%b5%b7%ef%bc%9a%e6%9b%be%e5%87%a0%e4%bd%95%e6%97%b6%e6%88%91%e2%80%a6%e2%80%a6&pics=https://img.shields.io/badge/Godot-%e5%ae%98%e6%96%b9%e6%96%87%e6%a1%a3-informational&site=Everybody%20Wants%20Some" title=分享到「QQ」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qq-icon"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741.0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792.0.0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a></div><div class="share-item qrcode"><div class=qrcode-container title=通过「二维码」><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id=qrcode-img></div></div><script src=https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js></script>
<script>var typeNumber=0,errorCorrectionLevel="L",qr=qrcode(typeNumber,errorCorrectionLevel);qr.addData("https://ews.ink/tech/game-godot-review-1-prepare/"),qr.make(),document.getElementById("qrcode-img").innerHTML=qr.createImgTag()</script></div></div></div><div class=related-posts><h2 class=related-title>相关文章：<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/tech/game-godot-trick-instance-tilemap/ class=related-link>Godot 3.4 使用 TileMap 实例化场景</a></li><li class=related-item><a href=/tech/game-godot-review-2-tutorial/ class=related-link>复习 Godot 开发流程 其二 重温教程</a></li></ul></div><footer class=minimal-footer><div class=post-tag><a href=/tags/godot/ rel=tag class=post-tag-link>#godot</a></div><div class=post-category><a href=/tech/ class="post-category-link active">tech</a> | <a href=/game/ class=post-category-link>game</a> | <a href=/life/ class=post-category-link>life</a></div></footer><ul class=post-nav><li class=post-nav-prev><a href=/tech/game-godot-review-2-tutorial/ rel=prev>&lt; 复习 Godot 开发流程 其二 重温教程</a></li><li class=post-nav-next><a href=/tech/blog-shortcode-mahjong/ rel=next>Hugo 魔改 shortcode 显示麻将牌 ></a></li></ul></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>©&nbsp;2018–2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;time2beat</div><div class=site-copyright><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a></div><div class=custom-footer><a href=http://www.beian.miit.gov.cn/ target=_blank rel=noopener>蜀ICP备17037841号-1</a></div></div></footer></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css integrity="sha256-gPJfuwTULrEAAcI3X4bALVU/2qBU+QY/TpoD3GO+Exw=" crossorigin=anonymous><script>if(typeof renderMathInElement=="undefined"){var getScript=t=>{var e=document.createElement("script");e.defer=!0,e.crossOrigin="anonymous",Object.keys(t).forEach(n=>{e[n]=t[n]}),document.body.appendChild(e)};getScript({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js",integrity:"sha256-YTW9cMncW/ZQMhY69KaUxIa2cPTxV87Uh627Gf5ODUw=",onload:()=>{getScript({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/mhchem.min.js",integrity:"sha256-yzSfYeVsWJ1x+2g8CYHsB/Mn7PcSp8122k5BM4T3Vxw=",onload:()=>{getScript({src:"https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js",integrity:"sha256-fxJzNV6hpc8tgW8tF0zVobKa71eTCRGTgxFXt1ZpJNM=",onload:()=>{renderKaTex()}})}})}})}else renderKaTex();function renderKaTex(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})}</script><script src=https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js></script>
<script>let mermaidConfig={startOnLoad:!0,flowchart:{useMaxWidth:!1,htmlLabels:!0},theme:"default"};mermaid.initialize(mermaidConfig)</script><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>mediumZoom(document.querySelectorAll("div.post-body img:not(a img, .sticker img, .ygo-card img, img[no-zoom], img[data-sticker], img[data-emoji], img.no-zoom, img.sticker, img.emoji)"),{background:"hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)"})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script>
<script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>